services:
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: socratic-backend
    ports:
      - "8000:8000"
    volumes:
      # Mount the models directory from the host to the container
      # Make sure the model exists at root ./models/ on your Droplet
      - ./models:/app/models
    environment:
      - JWT_SECRET_KEY=${JWT_SECRET_KEY:-change-me-in-production}
      - CORS_ORIGINS=${CORS_ORIGINS:-*}
      - MODEL_PATH=/app/models/socratic-q4_k_m.gguf
      - N_GPU_LAYERS=0
      - N_THREADS=4 
      - N_CTX=4096
    env_file:
      - .env
    restart: always

# Optional: Add Redis or DB here if needed later for session persistence
